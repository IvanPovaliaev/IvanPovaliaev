https://www.fileformat.info/info/unicode/category/So/list.htm
https://stackoverflow.com/questions/33580885/wmplib-console-app-exception-on-media-play

using System;
using System.Text;

public class MainClass
{
    public class ProgressBar
    {
        public int Length {get; private set;} //Длина строки прогресса
        private int currentProgress; //Текущий прогресс
        public int MaxValue {get; private set;} //Максимальный прогресс
        private int fillPosition;
        
        public ProgressBar()
        {
            Length = 10;
            currentProgress = 0;
            MaxValue = 100;
        }
        
        public void IncreaseProgresse(int value)
        {
            currentProgress += value;
            fillPosition = currentProgress*Length/MaxValue;
        }
        
        public string GetProgressBar()
        {
            var result = new StringBuilder(Length);
            var fillIndex = currentProgress / MaxValue;
            
            for (int i = 0; i < Length; i++)
            {
                if (i < fillPosition){
                    result.Append('\u2588');
                }
                else result.Append('\u2591');
            }
            return result.ToString();
        }
    }
    
    public static void Main()
    {
        Console.BackgroundColor = ConsoleColor.Yellow;
        Console.ForegroundColor = ConsoleColor.Black;
        var s =  new ProgressBar();
        for (int i =0; i < s.Length; i++)
        {
            s.IncreaseProgresse(7);
            Console.WriteLine(s.GetProgressBar());
        }
    }
}

Sub ExportToWordAsEquation()
    Dim wordApp As Object
    Dim wordDoc As Object
    Dim ws As Worksheet
    Dim cell As Range
    Dim eqRange As Object
    
    ' Устанавливаем соединение с Word
    On Error Resume Next
    Set wordApp = GetObject(class:="Word.Application")
    If wordApp Is Nothing Then
        Set wordApp = CreateObject(class:="Word.Application")
    End If
    On Error GoTo 0
    wordApp.Visible = True
    
    ' Создаем новый документ Word
    Set wordDoc = wordApp.Documents.Add
    
    ' Указываем лист и диапазон ячеек для экспорта
    Set ws = ThisWorkbook.Sheets("Sheet1") ' Измените на нужное имя листа
    
    ' Перебираем ячейки и добавляем их в уравнения в Word
    For Each cell In ws.Range("A1:A10") ' Замените диапазон на нужный вам
        If cell.Value <> "" Then
            ' Добавляем параграф для уравнения
            wordDoc.Paragraphs.Add
            Set eqRange = wordDoc.Paragraphs(wordDoc.Paragraphs.Count).Range
            eqRange.Text = cell.Value
            eqRange.OMaths.Add eqRange
            ProcessEquation eqRange.OMaths(1).Range
            eqRange.OMaths(1).BuildUp
        End If
    Next cell
End Sub

Sub ProcessEquation(eqRange As Object)
    ' Проходим по каждому символу и создаем уравнение с надстрочными и подстрочными индексами
    Dim i As Long
    Dim baseChar As Object
    Dim indexChar As Object
    Dim eq As Object
    
    ' Создаем уравнение для обработки
    Set eq = eqRange.OMaths(1)
    
    For i = 1 To eqRange.Characters.Count
        If Mid(eqRange.Text, i, 1) = "^" Then
            ' Создаем надстрочный индекс
            Set baseChar = eqRange.Characters(i - 1)
            Set indexChar = eqRange.Characters(i + 1)
            
            ' Используем встроенную функцию для создания надстрочного индекса
            With eq.Functions.Add(eqRange.Characters(i - 1), wdOMathFunctionSup)
                .Superscript.Range.Text = eqRange.Characters(i + 1).Text
            End With
            
            ' Удаляем исходные символы "^" и экспоненты
            eqRange.Characters(i + 1).Delete
            eqRange.Characters(i).Delete
        ElseIf Mid(eqRange.Text, i, 1) = "_" Then
            ' Создаем подстрочный индекс
            Set baseChar = eqRange.Characters(i - 1)
            Set indexChar = eqRange.Characters(i + 1)
            
            ' Используем встроенную функцию для создания подстрочного индекса
            With eq.Functions.Add(eqRange.Characters(i - 1), wdOMathFunctionSub)
                .Subscript.Range.Text = eqRange.Characters(i + 1).Text
            End With
            
            ' Удаляем исходные символы "_" и индексы
            eqRange.Characters(i + 1).Delete
            eqRange.Characters(i).Delete
        End If
    Next i
End Sub

---
Sub ConvertToWordEquation()
    Dim wordApp As Object
    Dim equationString As String
    
    ' Create a new instance of Microsoft Word
    Set wordApp = CreateObject("Word.Application")
    wordApp.Visible = True ' Optional: Make Word visible
    
    ' Define the equation string
    equationString = "w^2 + M_y"
    
    ' Create a new document in Word
    wordApp.Documents.Add
    
    ' Insert the equation into Word
    wordApp.Selection.Fields.Add wordApp.Selection.Range, Type:=wdFieldEmpty, Text:=equationString, PreserveFormatting:=True
    
    ' Clean up
    Set wordApp = Nothing
End Sub

_-----___

Sub CopyCellsToWord()
    Dim wordApp As Object
    Dim wordDoc As Object
    Dim wordRange As Object
    Dim eq As Object
    
    ' Создание экземпляра приложения Word
    Set wordApp = CreateObject("Word.Application")
    wordApp.Visible = True ' Сделать Word видимым (по желанию)
    
    ' Создание нового документа в Word
    Set wordDoc = wordApp.Documents.Add
    
    ' Создание объекта Range для вставки текста в документ Word
    Set wordRange = wordDoc.Content
    
    ' Вставка содержимого ячейки А1
    wordRange.InsertAfter Range("A1").Value & vbCrLf
    
    ' Вставка содержимого ячейки А2 как уравнение
    Set eq = wordDoc.OMaths.Add(wordRange)
    eq.Range.Text = Range("A2").Value
    
    ' Вставка содержимого ячейки А3
    wordRange.InsertAfter Range("A3").Value
    
    ' Освобождение ресурсов
    Set eq = Nothing
    Set wordRange = Nothing
    Set wordDoc = Nothing
    Set wordApp = Nothing
End Sub


Sub CopyCellsToWord()
    Dim wordApp As Object
    Dim wordDoc As Object
    Dim wordRange As Object
    Dim eq As Object
    
    ' Создание экземпляра приложения Word
    Set wordApp = CreateObject("Word.Application")
    wordApp.Visible = True ' Сделать Word видимым (по желанию)
    
    ' Создание нового документа в Word
    Set wordDoc = wordApp.Documents.Add
    
    ' Создание объекта Range для вставки текста в документ Word
    Set wordRange = wordDoc.Content
    
    ' Вставка содержимого ячейки А1
    wordRange.InsertAfter Range("A1").Value & vbCrLf
    
    ' Вставка содержимого ячейки А2 как уравнение
    Set eq = wordDoc.OMaths.Add(wordRange)
    eq.Range.Text = Range("A2").Value
    
    ' Вставка содержимого ячейки А3
    wordRange.InsertAfter Range("A3").Value
    
    ' Освобождение ресурсов
    Set eq = Nothing
    Set wordRange = Nothing
    Set wordDoc = Nothing
    Set wordApp = Nothing
End Sub

---
Sub CopyTextToWordEquation()
    Dim objWord As Object
    Dim objDoc As Object
    Dim rng As Range
    Dim equation As Object
    
    ' Создание экземпляра Word
    Set objWord = CreateObject("Word.Application")
    objWord.Visible = True
    
    ' Создание нового документа в Word
    Set objDoc = objWord.Documents.Add
    
    ' Выбор диапазона ячеек в Excel
    Set rng = ThisWorkbook.Sheets("Sheet1").Range("A1")
    
    ' Копирование текста в буфер обмена
    rng.Copy
    
    ' Вставка текста как формулы в Word
    objDoc.Range.PasteSpecial DataType:=wdPasteEquation
    
    ' Очистка буфера обмена
    Application.CutCopyMode = False
    
    ' Очистка ссылок на объекты
    Set objDoc = Nothing
    Set objWord = Nothing
    Set rng = Nothing
    Set equation = Nothing
End Sub

Sub ExportToWordEquation()
    Dim wdApp As Object
    Dim wdDoc As Object
    Dim rng As Range
    Dim equationText As String

    ' Создаем экземпляр приложения Word
    Set wdApp = CreateObject("Word.Application")
    wdApp.Visible = True ' делаем Word видимым

    ' Создаем новый документ Word
    Set wdDoc = wdApp.Documents.Add

    ' Копируем текст из ячейки А1
    Set rng = ThisWorkbook.Sheets("Sheet1").Range("A1")
    equationText = rng.Value
    
    ' Вставляем текст в документ Word
    wdDoc.Range.InsertAfter equationText

    ' Преобразуем в уравнение
    wdApp.Selection.OMaths.Add wdDoc.Range

    ' Освобождаем ресурсы
    Set rng = Nothing
    Set wdDoc = Nothing
    Set wdApp = Nothing
End Sub


