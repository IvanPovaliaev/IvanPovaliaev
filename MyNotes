import clr
clr.AddReference('RevitServices')
from RevitServices.Persistence import DocumentManager
from RevitServices.Transactions import TransactionManager
clr.AddReference('RevitAPI')
from Autodesk.Revit.DB import *

# Function to convert ARGB color values to Revit Color
def argb_to_color(argb):
    alpha = (argb >> 24) & 255
    red = (argb >> 16) & 255
    green = (argb >> 8) & 255
    blue = argb & 255
    return Color(red, green, blue)

# Get the current Revit document
doc = DocumentManager.Instance.CurrentDBDocument

# Get the active view
active_view = doc.ActiveView

# Get the ids of active filters in the active view
active_filter_ids = active_view.GetFilterIds()

# Convert the ids to ParameterFilterElement objects
active_filters = [doc.GetElement(filter_id) for filter_id in active_filter_ids]

# Input list of ARGB colors
argb_colors = IN[0]  # ARGB colors input parameter

# Start a transaction
TransactionManager.Instance.EnsureInTransaction(doc)

# Modify filter overrides based on input colors
for index, color in enumerate(argb_colors):
    if index < len(active_filters):
        # Extract RGB components from ARGB color
        alpha = (color >> 24) & 255
        red = (color >> 16) & 255
        green = (color >> 8) & 255
        blue = color & 255
        # Create Revit Color object
        rgb_color = Color(red, green, blue)
        filter = active_filters[index]
        overrides = active_view.GetFilterOverrides(filter.Id)
        overrides.SetForegroundPatternColor(rgb_color)
        active_view.SetFilterOverrides(filter.Id, overrides)

# Commit the transaction
TransactionManager.Instance.TransactionTaskDone()

# Output the list of active filters
OUT = active_filters
