https://www.fileformat.info/info/unicode/category/So/list.htm
https://stackoverflow.com/questions/33580885/wmplib-console-app-exception-on-media-play

using System;
using System.Text;

public class MainClass
{
    public class ProgressBar
    {
        public int Length {get; private set;} //Длина строки прогресса
        private int currentProgress; //Текущий прогресс
        public int MaxValue {get; private set;} //Максимальный прогресс
        private int fillPosition;
        
        public ProgressBar()
        {
            Length = 10;
            currentProgress = 0;
            MaxValue = 100;
        }
        
        public void IncreaseProgresse(int value)
        {
            currentProgress += value;
            fillPosition = currentProgress*Length/MaxValue;
        }
        
        public string GetProgressBar()
        {
            var result = new StringBuilder(Length);
            var fillIndex = currentProgress / MaxValue;
            
            for (int i = 0; i < Length; i++)
            {
                if (i < fillPosition){
                    result.Append('\u2588');
                }
                else result.Append('\u2591');
            }
            return result.ToString();
        }
    }
    
    public static void Main()
    {
        Console.BackgroundColor = ConsoleColor.Yellow;
        Console.ForegroundColor = ConsoleColor.Black;
        var s =  new ProgressBar();
        for (int i =0; i < s.Length; i++)
        {
            s.IncreaseProgresse(7);
            Console.WriteLine(s.GetProgressBar());
        }
    }
}

Sub ExportToWordAsEquation()
    Dim wordApp As Object
    Dim wordDoc As Object
    Dim ws As Worksheet
    Dim cell As Range
    
    ' Устанавливаем соединение с Word
    On Error Resume Next
    Set wordApp = GetObject(class:="Word.Application")
    If wordApp Is Nothing Then
        Set wordApp = CreateObject(class:="Word.Application")
    End If
    On Error GoTo 0
    wordApp.Visible = True
    
    ' Создаем новый документ Word
    Set wordDoc = wordApp.Documents.Add
    
    ' Указываем лист и диапазон ячеек для экспорта
    Set ws = ThisWorkbook.Sheets("Лист1")
    
    ' Перебираем ячейки и добавляем их в уравнения в Word
    For Each cell In ws.Range("A1:A10") ' Замените диапазон на нужный вам
        If cell.Value <> "" Then
            wordDoc.Paragraphs.Add
            wordDoc.Paragraphs(wordDoc.Paragraphs.Count).Range.Text = "=" & cell.Value
            wordDoc.Paragraphs(wordDoc.Paragraphs.Count).Range.OMaths.Add wordDoc.Paragraphs(wordDoc.Paragraphs.Count).Range
            wordDoc.Paragraphs(wordDoc.Paragraphs.Count).Range.OMaths.BuildUp
        End If
    Next cell
End Sub


Sub ExportToWordAsEquation()
    Dim wordApp As Object
    Dim wordDoc As Object
    Dim ws As Worksheet
    Dim cell As Range
    Dim eqRange As Object
    
    ' Устанавливаем соединение с Word
    On Error Resume Next
    Set wordApp = GetObject(class:="Word.Application")
    If wordApp Is Nothing Then
        Set wordApp = CreateObject(class:="Word.Application")
    End If
    On Error GoTo 0
    wordApp.Visible = True
    
    ' Создаем новый документ Word
    Set wordDoc = wordApp.Documents.Add
    
    ' Указываем лист и диапазон ячеек для экспорта
    Set ws = ThisWorkbook.Sheets("Лист1")
    
    ' Перебираем ячейки и добавляем их в уравнения в Word
    For Each cell In ws.Range("A1:A10") ' Замените диапазон на нужный вам
        If cell.Value <> "" Then
            ' Добавляем параграф для уравнения
            wordDoc.Paragraphs.Add
            Set eqRange = wordDoc.Paragraphs(wordDoc.Paragraphs.Count).Range
            eqRange.Text = "=" & cell.Value
            eqRange.OMaths.Add eqRange
            ProcessEquation eqRange.OMaths(1).Range
            eqRange.OMaths(1).BuildUp
        End If
    Next cell
End Sub

Sub ProcessEquation(ByVal eqRange As Range)
    ' Проходим по каждому символу и создаем уравнение с надстрочными индексами
    Dim i As Long
    Dim baseChar As Range
    Dim expChar As Range
    
    For i = 1 To eqRange.Characters.Count
        If Mid(eqRange.Text, i, 1) = "^" Then
            ' Создаем надстрочный индекс
            Set baseChar = eqRange.Characters(i - 1)
            Set expChar = eqRange.Characters(i + 1)
            
            With eqRange.OMaths(1).Functions.Add(baseChar, wdOMathFunctionSup)
                .Range.Characters(2).Text = expChar.Text
            End With
            
            ' Удаляем исходные символы "^" и экспоненты
            expChar.Delete
            eqRange.Characters(i).Delete
        End If
    Next i
End Sub

---
Sub ExportToWordAsEquation()
    Dim wordApp As Object
    Dim wordDoc As Object
    Dim ws As Worksheet
    Dim cell As Range
    Dim eqRange As Object
    
    ' Устанавливаем соединение с Word
    On Error Resume Next
    Set wordApp = GetObject(class:="Word.Application")
    If wordApp Is Nothing Then
        Set wordApp = CreateObject(class:="Word.Application")
    End If
    On Error GoTo 0
    wordApp.Visible = True
    
    ' Создаем новый документ Word
    Set wordDoc = wordApp.Documents.Add
    
    ' Указываем лист и диапазон ячеек для экспорта
    Set ws = ThisWorkbook.Sheets("Лист1")
    
    ' Перебираем ячейки и добавляем их в уравнения в Word
    For Each cell In ws.Range("A1:A10") ' Замените диапазон на нужный вам
        If cell.Value <> "" Then
            ' Добавляем параграф для уравнения
            wordDoc.Paragraphs.Add
            Set eqRange = wordDoc.Paragraphs(wordDoc.Paragraphs.Count).Range
            eqRange.Text = "=" & cell.Value
            eqRange.OMaths.Add eqRange
            ProcessEquation eqRange.OMaths(1).Range
            eqRange.OMaths(1).BuildUp
        End If
    Next cell
End Sub

Sub ProcessEquation(ByVal eqRange As Range)
    ' Проходим по каждому символу и создаем уравнение с надстрочными индексами
    Dim i As Long
    Dim baseChar As Range
    Dim expChar As Range
    
    For i = 1 To eqRange.Characters.Count
        If Mid(eqRange.Text, i, 1) = "^" Then
            ' Создаем надстрочный индекс
            Set baseChar = eqRange.Characters(i - 1)
            Set expChar = eqRange.Characters(i + 1)
            
            ' Используем встроенную функцию для создания надстрочного индекса
            With eqRange.OMaths(1).Functions.Add(baseChar, 1) ' 1 соответствует wdOMathFunctionSup
                .Range.Characters(2).Text = expChar.Text
            End With
            
            ' Удаляем исходные символы "^" и экспоненты
            expChar.Delete
            eqRange.Characters(i).Delete
        End If
    Next i
End Sub
-----

Sub ExportToWordAsEquation()
    Dim wordApp As Object
    Dim wordDoc As Object
    Dim ws As Worksheet
    Dim cell As Range
    Dim eqRange As Object
    
    ' Устанавливаем соединение с Word
    On Error Resume Next
    Set wordApp = GetObject(class:="Word.Application")
    If wordApp Is Nothing Then
        Set wordApp = CreateObject(class:="Word.Application")
    End If
    On Error GoTo 0
    wordApp.Visible = True
    
    ' Создаем новый документ Word
    Set wordDoc = wordApp.Documents.Add
    
    ' Указываем лист и диапазон ячеек для экспорта
    Set ws = ThisWorkbook.Sheets("Лист1")
    
    ' Перебираем ячейки и добавляем их в уравнения в Word
    For Each cell In ws.Range("A1:A10") ' Замените диапазон на нужный вам
        If cell.Value <> "" Then
            ' Добавляем параграф для уравнения
            wordDoc.Paragraphs.Add
            Set eqRange = wordDoc.Paragraphs(wordDoc.Paragraphs.Count).Range
            eqRange.Text = "=" & cell.Value
            eqRange.OMaths.Add eqRange
            ProcessEquation eqRange.OMaths(1).Range
            eqRange.OMaths(1).BuildUp
        End If
    Next cell
End Sub

Sub ProcessEquation(eqRange As Object)
    ' Проходим по каждому символу и создаем уравнение с надстрочными индексами
    Dim i As Long
    Dim baseChar As Object
    Dim expChar As Object
    Dim eq As Object
    
    ' Создаем уравнение для обработки
    Set eq = eqRange.OMaths(1)
    
    For i = 1 To eqRange.Characters.Count
        If Mid(eqRange.Text, i, 1) = "^" Then
            ' Создаем надстрочный индекс
            Set baseChar = eqRange.Characters(i -


------
Sub ExportToWordAsEquation()
    Dim wordApp As Object
    Dim wordDoc As Object
    Dim ws As Worksheet
    Dim cell As Range
    Dim eqRange As Object
    
    ' Устанавливаем соединение с Word
    On Error Resume Next
    Set wordApp = GetObject(class:="Word.Application")
    If wordApp Is Nothing Then
        Set wordApp = CreateObject(class:="Word.Application")
    End If
    On Error GoTo 0
    wordApp.Visible = True
    
    ' Создаем новый документ Word
    Set wordDoc = wordApp.Documents.Add
    
    ' Указываем лист и диапазон ячеек для экспорта
    Set ws = ThisWorkbook.Sheets("Лист1")
    
    ' Перебираем ячейки и добавляем их в уравнения в Word
    For Each cell In ws.Range("A1:A10") ' Замените диапазон на нужный вам
        If cell.Value <> "" Then
            ' Добавляем параграф для уравнения
            wordDoc.Paragraphs.Add
            Set eqRange = wordDoc.Paragraphs(wordDoc.Paragraphs.Count).Range
            eqRange.Text = "=" & cell.Value
            eqRange.OMaths.Add eqRange
            ProcessEquation eqRange.OMaths(1).Range
            eqRange.OMaths(1).BuildUp
        End If
    Next cell
End Sub

Sub ProcessEquation(eqRange As Object)
    ' Проходим по каждому символу и создаем уравнение с надстрочными индексами
    Dim i As Long
    Dim baseChar As Object
    Dim expChar As Object
    Dim eq As Object
    
    ' Создаем уравнение для обработки
    Set eq = eqRange.OMaths(1)
    
    For i = 1 To eqRange.Characters.Count
        If Mid(eqRange.Text, i, 1) = "^" Then
            ' Создаем надстрочный индекс
            Set baseChar = eqRange.Characters(i - 1)
            Set expChar = eqRange.Characters(i + 1)
            
            ' Используем встроенную функцию для создания надстрочного индекса
            With eq.Functions.Add(baseChar, 1) ' 1 соответствует wdOMathFunctionSup
                .Superscript.Range.Text = expChar.Text
            End With
            
            ' Удаляем исходные символы "^" и экспоненты
            expChar.Delete
            eqRange.Characters(i).Delete
        End If
    Next i
End Sub

---
Sub ExportToWordAsEquation()
    Dim wordApp As Object
    Dim wordDoc As Object
    Dim ws As Worksheet
    Dim cell As Range
    Dim eqRange As Object
    
    ' Устанавливаем соединение с Word
    On Error Resume Next
    Set wordApp = GetObject(class:="Word.Application")
    If wordApp Is Nothing Then
        Set wordApp = CreateObject(class:="Word.Application")
    End If
    On Error GoTo 0
    wordApp.Visible = True
    
    ' Создаем новый документ Word
    Set wordDoc = wordApp.Documents.Add
    
    ' Указываем лист и диапазон ячеек для экспорта
    Set ws = ThisWorkbook.Sheets("Лист1")
    
    ' Перебираем ячейки и добавляем их в уравнения в Word
    For Each cell In ws.Range("A1:A10") ' Замените диапазон на нужный вам
        If cell.Value <> "" Then
            ' Добавляем параграф для уравнения
            wordDoc.Paragraphs.Add
            Set eqRange = wordDoc.Paragraphs(wordDoc.Paragraphs.Count).Range
            eqRange.Text = "=" & cell.Value
            eqRange.OMaths.Add eqRange
            ProcessEquation eqRange.OMaths(1).Range
            eqRange.OMaths(1).BuildUp
        End If
    Next cell
End Sub

Sub ProcessEquation(eqRange As Object)
    ' Проходим по каждому символу и создаем уравнение с надстрочными и подстрочными индексами
    Dim i As Long
    Dim baseChar As Object
    Dim indexChar As Object
    Dim eq As Object
    
    ' Создаем уравнение для обработки
    Set eq = eqRange.OMaths(1)
    
    For i = 1 To eqRange.Characters.Count
        If Mid(eqRange.Text, i, 1) = "^" Then
            ' Создаем надстрочный индекс
            Set baseChar = eqRange.Characters(i - 1)
            Set indexChar = eqRange.Characters(i + 1)
            
            ' Используем встроенную функцию для создания надстрочного индекса
            With eq.Functions.Add(baseChar, wdOMathFunctionSup)
                .Superscript.Range.Text = indexChar.Text
            End With
            
            ' Удаляем исходные символы "^" и экспоненты
            indexChar.Delete
            eqRange.Characters(i).Delete
            
        ElseIf Mid(eqRange.Text, i, 1) = "_" Then
            ' Создаем подстрочный индекс
            Set baseChar = eqRange.Characters(i - 1)
            Set indexChar = eqRange.Characters(i + 1)
            
            ' Используем встроенную функцию для создания подстрочного индекса
            With eq.Functions.Add(baseChar, wdOMathFunctionSub)
                .Subscript.Range.Text = indexChar.Text
            End With
            
            ' Удаляем исходные символы "_" и индексы
            indexChar.Delete
            eqRange.Characters(i).Delete
        End If
    Next i
End Sub





