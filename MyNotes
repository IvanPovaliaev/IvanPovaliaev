Sub ConvertToEquations()
    Dim doc As Document
    Dim startPos As Long, endPos As Long
    Dim searchRange As Range
    Dim equationText As String
    
    ' Указываем активный документ
    Set doc = ActiveDocument
    
    ' Начинаем поиск
    Set searchRange = doc.Content
    
    ' Ищем "<<"
    With searchRange.Find
        .Text = "<<"
        .Forward = True
        .Wrap = wdFindStop
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
        
        Do While .Execute
            startPos = searchRange.End
            searchRange.Collapse wdCollapseEnd
            
            ' Ищем ">>" после "<<"
            searchRange.Find.Text = ">>"
            If searchRange.Find.Execute Then
                endPos = searchRange.Start
                searchRange.Collapse wdCollapseStart
                
                ' Извлекаем текст между "<<...>>"
                equationText = Mid(doc.Range(startPos, endPos).Text, 1, Len(doc.Range(startPos, endPos).Text))
                
                ' Удаляем "<<...>>"
                doc.Range(startPos - 2, endPos + 2).Delete
                
                ' Вставляем уравнение на место "<<...>>"
                doc.Range(startPos - 2).InsertParagraphAfter
                doc.Range(startPos - 2).MoveEnd wdCharacter, 1
                doc.OMaths.Add doc.Range(startPos - 2).Paragraphs(1).Range
                doc.Range(startPos - 2).Paragraphs(1).Range.Text = equationText
                
                ' Обновляем диапазон для поиска следующего "<<"
                Set searchRange = doc.Content
                searchRange.Start = startPos
                searchRange.End = doc.Content.End
            Else
                ' Если ">>" не найден, заканчиваем поиск
                Exit Do
            End If
        Loop
    End With
End Sub
